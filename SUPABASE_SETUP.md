# Supabase Setup Guide

To enable dynamic project management, follow these steps to set up your Supabase database:

1.  **Create a Project**: Go to [Supabase](https://supabase.com/) and create a new project.
2.  **Get Credentials**:
    *   Go to **Project Settings** -> **API**.
    *   Copy the `URL` and `anon public` key.
    *   Add them to your `.env.local` file (create it if it doesn't exist):

    ```env
    NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
    ```

3.  **Run SQL Query**: Go to the **SQL Editor** in your Supabase dashboard and run the following script to create the `projects` table and enable Row Level Security (RLS) policies.

```sql
-- Create the projects table
create table projects (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  title text not null,
  description text not null,
  long_description text,
  image text not null,
  tags text[] not null,
  category text not null,
  github_link text,
  live_link text,
  featured boolean default false
);

-- Enable Row Level Security (RLS)
alter table projects enable row level security;

-- Create a policy that allows anyone to read projects (Public Access)
create policy "Public projects are viewable by everyone"
  on projects for select
  using ( true );

-- Create a policy that allows only authenticated users to insert/update/delete
-- NOTE: By default this allows any logged in user. Since we are using a simple email login for admin, 
-- you might want to restrict this further or just ensure only YOU have the login credentials.
create policy "Authenticated users can insert projects"
  on projects for insert
  with check ( auth.role() = 'authenticated' );

create policy "Authenticated users can update projects"
  on projects for update
  using ( auth.role() = 'authenticated' );

create policy "Authenticated users can delete projects"
  on projects for delete
  using ( auth.role() = 'authenticated' );

-- Create a bucket for project images (Optional if you want to upload images)
insert into storage.buckets (id, name, public) values ('project-images', 'project-images', true);

-- Create policy for public read access to images
create policy "Project images are publicly accessible"
  on storage.objects for select
  using ( bucket_id = 'project-images' );

-- Create policy for authenticated uploads
create policy "Authenticated users can upload images"
  on storage.objects for insert
  with check ( bucket_id = 'project-images' and auth.role() = 'authenticated' );
```

4.  **Create a User**: Go to **Authentication** -> **Users** and add a user (this will be your admin account).

5.  **Create Site Content Table**: Run this SQL to enable dynamic content values:

```sql
-- Create the site_content table
create table site_content (
  id bigint generated by default as identity primary key,
  section_key text not null unique,
  content jsonb not null default '{}'::jsonb,
  updated_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Enable RLS
alter table site_content enable row level security;

-- Public read access
create policy "Public content is viewable by everyone"
  on site_content for select
  using ( true );

-- Authenticated update access
create policy "Authenticated users can update content"
  on site_content for update
  using ( auth.role() = 'authenticated' );

-- Authenticated insert access
create policy "Authenticated users can insert content"
  on site_content for insert
  with check ( auth.role() = 'authenticated' );
```
